<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analizador de C√≥digo Java</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .input-section {
            margin-bottom: 30px;
        }

        .input-section label {
            display: block;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
            font-size: 1.1em;
        }

        .code-input {
            width: 100%;
            height: 300px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .code-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .button-section {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .analysis-section {
            margin-top: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(116, 185, 255, 0.3);
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-card p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .results-section {
            margin-top: 30px;
        }

        .result-header {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px 8px 0 0;
            border-left: 4px solid #667eea;
            font-weight: bold;
            color: #333;
        }

        .table-container {
            overflow-x: auto;
            border: 1px solid #ddd;
            border-radius: 0 0 8px 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: bold;
            color: #333;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .token-type {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .token-keyword { background: #e74c3c; color: white; }
        .token-identifier { background: #3498db; color: white; }
        .token-number { background: #f39c12; color: white; }
        .token-string { background: #27ae60; color: white; }
        .token-symbol { background: #9b59b6; color: white; }
        .token-comment { background: #95a5a6; color: white; }

        .error-row {
            background: #ffe6e6 !important;
        }

        .error-message {
            color: #e74c3c;
            font-weight: bold;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .button-section {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container" >
     <section>
        
     </section>
         <div id="lexErrorsSection" class="hidden">
                    <div class="result-header">‚ùå Errores L√©xicos</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>L√≠nea</th>
                                    <th>Error</th>
                                </tr>
                            </thead>
                            <tbody id="lexErrorsTable"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Errores Sint√°cticos -->
                <div id="synErrorsSection" class="hidden">
                    <div class="result-header">‚ö†Ô∏è Errores Sint√°cticos</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>L√≠nea</th>
                                    <th>Error</th>
                                </tr>
                            </thead>
                            <tbody id="synErrorsTable"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Errores Sem√°nticos -->
                <div id="semErrorsSection" class="hidden">
                    <div class="result-header">üîç Errores Sem√°nticos</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>L√≠nea</th>
                                    <th>Error</th>
                                </tr>
                            </thead>
                            <tbody id="semErrorsTable"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Mensaje de √©xito -->
                <div id="successMessage" class="success-message hidden">
                    ‚úÖ ¬°C√≥digo analizado correctamente! No se encontraron errores.
                </div>
        <div class="header">
            <h1>üîç Analizador de C√≥digo Java</h1>
    
        </div>

        <div class="main-content">
            <div class="input-section">
                <label for="codeInput">Ingresa tu c√≥digo Java:</label>
                <textarea id="codeInput" class="code-input" placeholder="public class MiClase {
    public static void main(String[] args) {
        System.out.println(&quot;Hola Mundo&quot;);
    }
}"></textarea>
            </div>

            <div class="button-section">
                <button id="lexBtn" class="btn btn-primary">An√°lisis L√©xico</button>
                <button id="synBtn" class="btn btn-primary" disabled>An√°lisis Sint√°ctico</button>
                <button id="semBtn" class="btn btn-primary" disabled>An√°lisis Sem√°ntico</button>
            </div>

            <div id="loadingDiv" class="loading hidden">
                <div class="spinner"></div>
                Analizando c√≥digo...
            </div>

            <div id="statsSection" class="hidden">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="totalTokens">0</h3>
                        <p>Total Tokens</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="keywordCount">0</h3>
                        <p>Palabras Reservadas</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="identifierCount">0</h3>
                        <p>Identificadores</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="symbolCount">0</h3>
                        <p>S√≠mbolos</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="numberCount">0</h3>
                        <p>N√∫meros</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="stringCount">0</h3>
                        <p>Cadenas</p>
                    </div>
                </div>
            </div>

            <div id="resultsSection" class="results-section hidden">
                <!-- Tokens -->
                <div id="tokensSection" class="hidden">
                    <div class="result-header">üìù Tokens Identificados</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Tipo</th>
                                    <th>Valor</th>
                                    <th>L√≠nea</th>
                                </tr>
                            </thead>
                            <tbody id="tokensTable"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Errores L√©xicos -->
                <div id="lexErrorsSection" class="hidden">
                    <div class="result-header">‚ùå Errores L√©xicos</div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>L√≠nea</th>
                                    <th>Error</th>
                                </tr>
                            </thead>
                            <tbody id="lexErrorsTable"></tbody>
                        </table>
                    </div>
                </div>

          
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:8080/analyze';
        
        let currentAnalysis = null;
        
        // Referencias a elementos DOM
        const codeInput = document.getElementById('codeInput');
        const lexBtn = document.getElementById('lexBtn');
        const synBtn = document.getElementById('synBtn');
        const semBtn = document.getElementById('semBtn');
        const loadingDiv = document.getElementById('loadingDiv');
        const statsSection = document.getElementById('statsSection');
        const resultsSection = document.getElementById('resultsSection');
        
        // Event listeners
        lexBtn.addEventListener('click', performLexicalAnalysis);
        synBtn.addEventListener('click', performSyntacticAnalysis);
        semBtn.addEventListener('click', performSemanticAnalysis);
        
        // Funci√≥n para realizar an√°lisis l√©xico
        async function performLexicalAnalysis() {
            const code = codeInput.value.trim();
            if (!code) {
                alert('Por favor ingresa c√≥digo Java para analizar');
                return;
            }
            
            showLoading(true);
            resetResults();
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ code: code })
                });
                
                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }
                
                currentAnalysis = await response.json();
                
                // Mostrar estad√≠sticas
                showStats(currentAnalysis.stats);
                
                // Mostrar tokens
                showTokens(currentAnalysis.tokens);
                
                // Mostrar errores l√©xicos
                if (currentAnalysis.lex_errors && currentAnalysis.lex_errors.length > 0) {
                    showLexicalErrors(currentAnalysis.lex_errors);
                    synBtn.disabled = true;
                    semBtn.disabled = true;
                } else {
                    // Habilitar an√°lisis sint√°ctico si no hay errores l√©xicos
                    synBtn.disabled = false;
                    semBtn.disabled = true;
                }
                
                resultsSection.classList.remove('hidden');
                
            } catch (error) {
                console.error('Error:', error);
                alert('Error al conectar con el servidor. Aseg√∫rate de que la API est√© corriendo en :8080');
            } finally {
                showLoading(false);
            }
        }
        
        // Funci√≥n para realizar an√°lisis sint√°ctico
        function performSyntacticAnalysis() {
            if (!currentAnalysis) return;
            
            resetResults();
            showStats(currentAnalysis.stats);
            showTokens(currentAnalysis.tokens);
            
            if (currentAnalysis.syn_errors && currentAnalysis.syn_errors.length > 0) {
                showSyntacticErrors(currentAnalysis.syn_errors);
                semBtn.disabled = true;
            } else {
                // Habilitar an√°lisis sem√°ntico si no hay errores sint√°cticos
                semBtn.disabled = false;
            }
            
            resultsSection.classList.remove('hidden');
        }
        
        // Funci√≥n para realizar an√°lisis sem√°ntico
        function performSemanticAnalysis() {
            if (!currentAnalysis) return;
            
            resetResults();
            showStats(currentAnalysis.stats);
            showTokens(currentAnalysis.tokens);
            
            if (currentAnalysis.sem_errors && currentAnalysis.sem_errors.length > 0) {
                showSemanticErrors(currentAnalysis.sem_errors);
            } else {
                // Mostrar mensaje de √©xito
                document.getElementById('successMessage').classList.remove('hidden');
            }
            
            resultsSection.classList.remove('hidden');
        }
        
        // Funci√≥n para mostrar/ocultar loading
        function showLoading(show) {
            if (show) {
                loadingDiv.classList.remove('hidden');
            } else {
                loadingDiv.classList.add('hidden');
            }
        }
        
        // Funci√≥n para resetear resultados
        function resetResults() {
            const sections = ['tokensSection', 'lexErrorsSection', 'synErrorsSection', 'semErrorsSection', 'successMessage'];
            sections.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
        }
        
        // Funci√≥n para mostrar estad√≠sticas
        function showStats(stats) {
            document.getElementById('totalTokens').textContent = stats.total_tokens;
            document.getElementById('keywordCount').textContent = stats.keywords;
            document.getElementById('identifierCount').textContent = stats.identifiers;
            document.getElementById('symbolCount').textContent = stats.symbols;
            document.getElementById('numberCount').textContent = stats.numbers;
            document.getElementById('stringCount').textContent = stats.strings;
            
            statsSection.classList.remove('hidden');
        }
        
        // Funci√≥n para mostrar tokens
        function showTokens(tokens) {
            const tbody = document.getElementById('tokensTable');
            tbody.innerHTML = '';
            
            tokens.forEach((token, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><span class="token-type token-${token.type}">${token.type}</span></td>
                    <td><code>${escapeHtml(token.value)}</code></td>
                    <td>${token.line}</td>
                `;
            });
            
            document.getElementById('tokensSection').classList.remove('hidden');
        }
        
        // Funci√≥n para mostrar errores l√©xicos
        function showLexicalErrors(errors) {
            const tbody = document.getElementById('lexErrorsTable');
            tbody.innerHTML = '';
            
            errors.forEach(error => {
                const row = tbody.insertRow();
                row.className = 'error-row';
                row.innerHTML = `
                    <td>${error.line}</td>
                    <td class="error-message">${escapeHtml(error.message)}</td>
                `;
            });
            
            document.getElementById('lexErrorsSection').classList.remove('hidden');
        }
        
        // Funci√≥n para mostrar errores sint√°cticos
        function showSyntacticErrors(errors) {
            const tbody = document.getElementById('synErrorsTable');
            tbody.innerHTML = '';
            
            errors.forEach(error => {
                const row = tbody.insertRow();
                row.className = 'error-row';
                row.innerHTML = `
                    <td>${error.line}</td>
                    <td class="error-message">${escapeHtml(error.message)}</td>
                `;
            });
            
            document.getElementById('synErrorsSection').classList.remove('hidden');
        }
        
        // Funci√≥n para mostrar errores sem√°nticos
        function showSemanticErrors(errors) {
            const tbody = document.getElementById('semErrorsTable');
            tbody.innerHTML = '';
            
            errors.forEach(error => {
                const row = tbody.insertRow();
                row.className = 'error-row';
                row.innerHTML = `
                    <td>${error.line}</td>
                    <td class="error-message">${escapeHtml(error.message)}</td>
                `;
            });
            
            document.getElementById('semErrorsSection').classList.remove('hidden');
        }
        
        // Funci√≥n helper para escapar HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Resetear estado cuando cambie el c√≥digo
        codeInput.addEventListener('input', function() {
            synBtn.disabled = true;
            semBtn.disabled = true;
            currentAnalysis = null;
            statsSection.classList.add('hidden');
            resultsSection.classList.add('hidden');
        });
        
        // Ejemplo de c√≥digo Java por defecto
        codeInput.value = `public class HolaMundo {
    public static void main(String[] args) {
        System.out.println("Hola Mundo desde Java!");
        
        int numero = 42;
        String nombre = "Java";
        
        for (int i = 0; i < 3; i++) {
            System.out.println("Iteraci√≥n: " + i);
        }
    }
}`;
    </script>
</body>
</html>